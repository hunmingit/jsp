<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="org.joonzis.mybatis.mapper.bbs"> 
		<!-- 전체 게시글 목록
		<select id="bbs_select_all" resultType="org.joonzis.vo.BVO">
			SELECT * FROM bbs_t ORDER BY b_idx DESC
		</select> -->
		<select id="bbs_select__all_with_paging" resultType="org.joonzis.vo.BVO">
			<![CDATA[
						SELECT b_idx, writer, title, hit, reg_date
						from
							(SELECT ROWNUM rn, a.* 
							from
							(SELECT b_idx, writer, title, hit, reg_date 
							from bbs_t
							ORDER BY b_idx desc) a
						where ROWNUM <= #{pageNum} * #{amount})
					where rn > (#{pageNum}-1) * #{amount}
			]]>

		</select>
		<!-- 게시글 등록 -->
		<insert id="bbs_insert" parameterType="org.joonzis.vo.BVO" >
			INSERT INTO bbs_t (b_idx, writer, 
			title, content, 
			pw, ip, 
			filename, reg_date, hit)
			VALUES (bbs_seq.nextval, #{writer}, 
			#{title}, #{content}, 
			#{pw}, #{ip}, 
			#{filename}, SYSDATE, 0)
		</insert>
		
		<!-- 게시글 상세보기 -->
		<select id="bbs_by_idx" parameterType="int" resultType="org.joonzis.vo.BVO">
			SELECT * FROM bbs_t WHERE b_idx = #{b_idx}
		</select>
		
		<!--조회수 증가-->
		<update id="update_hit" parameterType="org.joonzis.vo.BVO">
			UPDATE bbs_t SET hit = #{hit} WHERE b_idx = #{b_idx}
		</update>
		
		<!--게시글 수정하기-->
		<update id ="bbs_update" parameterType="org.joonzis.vo.BVO">
			update bbs_t
			set title = #{title}, content = #{content}, filename = #{filename}
			where b_idx = #{b_idx}
		</update>

		<!--게시글 삭제하기-->
		<delete id="bbs_delete" parameterType="int">
			DELETE FROM bbs_t WHERE b_idx = #{b_idx}
		</delete>

		<!--전체 게시글 수 가져오기-->
		<select id="bbs_get_total_count" resultType="int">
			SELECT COUNT(*) FROM bbs_t
		</select>


</mapper>






